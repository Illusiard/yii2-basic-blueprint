#!/usr/bin/env php
<?php

require __DIR__ . '/../vendor/autoload.php';

use Illusiard\Yii2BasicBlueprint\Bootstrap;
use Illusiard\Yii2BasicBlueprint\Support\ConsolePhpVersionResolver;
use Illusiard\Yii2BasicBlueprint\Support\JsonBlueprintConfigWriter;
use Illusiard\Yii2BasicBlueprint\Support\ProcessRunner;
use Symfony\Component\Console\Output\ConsoleOutput;

$output = new ConsoleOutput();

$bootstrap = new Bootstrap(
    runner: new ProcessRunner($output),
    phpResolver: new ConsolePhpVersionResolver($output),
    configWriter: new JsonBlueprintConfigWriter()
);

$root = getcwd();
if ($root === false) {
    fwrite(STDERR, "Cannot determine working directory.\n");
    exit(1);
}

exit($bootstrap->run($root));
